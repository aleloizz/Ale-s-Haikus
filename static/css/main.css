/* 
===== MAIN.CSS - DYNAMIC CONTENT-BASED SIZING =====
Versione: 1.36 - nuovi colori per errorToast

/* ===== VARIABILI CSS CONDIVISE ===== */
:root { 
  --primary: #D4B8FF;
  --secondary: #FFE5D9;
  --accent: #A2D7D8;
  --text: #5E5E5E;
  --bg: #FAF7FF;
  --error: #ff6b6b;
  --success: #3bb156;
}

/* Toast error dedicato (estratto da inline style in index.html) */
.toast-error {
  background: rgba(220, 53, 70, 0.437) !important;
  color: #fff !important;
  border: 1px solid rgb(196, 42, 58) !important;
  border-radius: 1rem;

  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: 0 !important;
}

.toast-error .btn-close {
  filter: invert(1) grayscale(1) brightness(200%);
  opacity: .85;
}
.toast-error .btn-close:hover { opacity: 1; }

html, body {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  margin: 0;
  padding: 0;
  font-family: 'Inter', sans-serif;
  color: var(--text);
  
  /* Fallback per tutti i browser */
  background-color: #fbbda3;
  background-image: url('../images/background.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  width: 100vw;
}

/* Supporto WebP moderno */
@supports (background-image: url('data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA')) {
  html, body {
    background-image: url('../images/background.webp');
  }
}

h2 {
  font-family: 'Inter', sans-serif;
  font-weight: 500;
  color: white;
  text-align: center;
  margin: 0;
}

body {
  font-family: 'Inter', sans-serif;
  color: var(--text);
  min-height: 100vh;
  flex: 1 0 auto;
  display: flex;
  flex-direction: column;
}

main {
  flex: 1 0 auto;
  transition: margin-top 0.4s cubic-bezier(0.25, 0.1, 0.25, 1);
  will-change: transform;
}

header {
  transition: transform 0.4s cubic-bezier(0.25, 0.1, 0.25, 1);
  will-change: transform;
}

footer {
  flex-shrink: 0;
  
  width: 100vw;
  text-align: center;
  word-break: break-word;
  z-index: 10;
  padding: 1rem 0.5rem;
  box-sizing: border-box;
  padding-bottom: calc(1rem + env(safe-area-inset-bottom));
}

/* Header/Footer background helper used in index.html */
.bg-haiku-primary{
  background: transparent !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  border: none !important;
  box-shadow: none !important;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

body::after {
  content: '';
  display: none;
  width: 100%;
  pointer-events: none;
}

/* wrapper per il contenuto principale */
.main-wrapper {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background: none !important;
}

.card {
  background: rgba(255, 255, 233, 0.200);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-radius: 20px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  box-shadow: 
  0 0 0 1px rgba(255,255,255,0.1),
  0 2px 30px rgba(149, 117, 205, 0.1),
  0 0 60px rgba(149, 117, 205, 0.05);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

/* Select della nazionalità: più grande, glass, con bordo colorato */
#poemNation {
  background: rgba(255, 255, 255, 0.5);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: 2px solid var(--primary, #a084e8);
  color: #5a3fa0;
  font-weight: 400;
  font-size: 1.15rem;
  border-radius: 2rem;
  box-shadow: 
    0 4px 6px rgba(0, 0, 0, 0.1),
    0 1px 3px rgba(0, 0, 0, 0.08);
  padding: 0.85rem 2.5rem 0.85rem 1.2rem;
  margin-bottom: 0.5rem;
  transition: border-color 0.2s, box-shadow 0.2s;
}

#poemNation:hover,
#poemNation:focus {
  transform: translateY(-2px);
  border-color: #5a3fa0;
  box-shadow:
    0 6px 12px rgba(110, 86, 166, 0.15),
    0 3px 6px rgba(160, 117, 205, 0.1);
  outline: none;
  transition: border-color 0.2s, box-shadow 0.2s, transform 0.3s;
}

/* Icona select più visibile */
#poemNation ~ .select-icon i {
  color: #5a3fa0;
  font-size: 1.3em;
  top: 50%;
  right: 1.2rem;
  pointer-events: none;
}

/* Label della nazionalità più marcata */
.form-select-label:first-child {
  font-size: 1.1rem;
  color: var(--text);
  letter-spacing: 0.5px;
  margin-bottom: 0.2rem;
}

/* Label della nazionalità: viola, effetto hover fluido */
.form-select-label.nation-label {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--primary, #a084e8);
  letter-spacing: 0.5px;
  margin-bottom: 0.2rem;
  transition: color 0.3s, transform 0.3s;
  cursor: pointer;
  text-align: center;
}
.form-select-label.nation-label:hover {
  color: #5a3fa0;
  transform: translateY(-2px) scale(1.04);
}

/* Label della tipologia: arancione, stesso stile della nazionalità */
.form-select-label.type-label {
  font-size: 1.1rem;
  font-weight: 700;
  color: #d76f43;
  letter-spacing: 0.5px;
  margin-bottom: 0.2rem;
  transition: color 0.3s, transform 0.3s;
  cursor: pointer;
  text-align: center;
}
.form-select-label.type-label:hover {
  color: #b85c2b;
  transform: translateY(-2px) scale(1.04);
}

/* Stile avanzato per il selettore poesia */
.form-select-container {
  position: relative;
  margin: 1rem auto;
  width: fit-content;
}

.form-select-label {
  display: block;
  margin-bottom: 0.5rem;
  color: var(--text);
  font-weight: 500;
  text-align: center;
}

.form-select {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  width: 200px;
  padding: 0.8rem 2rem 0.8rem 1.5rem;
  border: 2px solid var(--secondary, #ffe5d9);
  border-radius: 50px;
  background-color: rgba(255, 255, 255, 0.5);
  backdrop-filter: blur(10px);
  box-shadow: 
    0 4px 6px rgba(0, 0, 0, 0.1),
    0 1px 3px rgba(0, 0, 0, 0.08);
  font-family: 'Inter', sans-serif;
  color: #b85c2b;
  font-weight: 400;
  font-size: 1.15rem;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
  background-image: none; /* Rimuove la freccia nativa di Bootstrap */
  padding-right: 3rem; /* Spazio per la nostra icona */
}

.form-select:hover {
  transform: translateY(-2px);
  border-color: #d76f43;
  box-shadow: 
    0 6px 12px rgba(205, 158, 117, 0.15),
    0 3px 6px rgba(205, 158, 117, 0.1);
}

.form-select:focus {
  outline: none;
  box-shadow: 
    0 0 0 2px rgba(190, 118, 82, 0.578),
    0 6px 12px rgba(205, 164, 117, 0.2);
}

.select-icon {
  position: absolute;
  right: 1.2rem;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
  color: #b85c2b;
  transition: transform 0.3s ease;
  z-index: 2; /* Assicurati che sia sopra al selettore */
}

.select-icon i {
  font-size: 1.2rem;
  filter: drop-shadow(0 1px 1px rgba(0,0,0,0.1));
}

.form-select:focus + .select-icon i {
  color: var(--accent); /* Cambia colore al focus */
}

/* Rimuove la freccia nera residua su alcuni browser */
.form-select::-ms-expand {
  display: none;
}

.form-select:focus + .select-icon {
  transform: translateY(-50%) rotate(180deg);
}

/* Effetto per opzioni */
.form-select option {
  background: rgba(255, 255, 255, 0.9);
  color: var(--text);
  padding: 0.5rem;
  border-radius: 0;
}

.btn-more {
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(5px);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: white;
  border-radius: 50px;
  padding: 10px 20px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.btn-more:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

button:active {
  translate: 0 0.225em;
  box-shadow: inset 0 0.03em 0 0 #f4f4f4, 0 0.03em 0 0 #efefef,
    0 0.0625em 0 0 #ececec, 0 0.125em 0 0 #e0e0e0, 0 0.125em 0 0 #dedede,
    0 0.2em 0 0 #dcdcdc, 0 0.225em 0 0 #cacaca, 0 0.225em 0.375em 0 #cecece;
}

.btn-haiku {
  transition: all 0.3s ease;
  border-radius: 50px;
  padding: 10px 16px !important;
}

.btn-haiku.btn-primary {
  background: var(--primary);
  border: none;
}

.btn-haiku.btn-secondary {
  background: var(--secondary);
  color: var(--text);
  border: none;
}

.btn-haiku:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(212, 184, 255, 0.3);
}

/* Ensure consistent button sizing across all devices */
.btn-haiku {
  font-size: 1rem !important;
  line-height: 1.5 !important;
  min-height: 44px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  white-space: nowrap !important;
  font-weight: 500 !important;
  border-radius: 2rem !important;
}
.btn-haiku i{margin-right:.5rem;display:inline-block;line-height:0}

/* Checkbox label alignment (publishPoem, useTolerance) */
.form-check{
  display: flex;
  align-items: center;
  gap: .5rem;
}
.form-check-input{
  margin: 0 !important;
  flex: 0 0 auto !important; /* do not shrink */
  width: 1.1rem !important;
  height: 1.1rem !important;
  min-width: 1.1rem !important;
  min-height: 1.1rem !important;
}
.form-check-label{
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  line-height: 1.2;
}

/* Prevent checkbox column from shrinking next to buttons on md+ */
.d-md-flex.justify-content-md-between > .d-flex.flex-column {
  flex-shrink: 0 !important;
}

.syllable-badge {
  background: var(--secondary);
  color: #d76f43;
  transition: all 0.3s ease;
  min-width: 2.5rem;
}

.syllable-badge.correct {
  background-color: var(--success) !important;
  transform: scale(1.05);
  color: white !important;
}

/* Transizione ai bordi */
textarea, .form-control {
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

textarea:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 0.25rem rgba(212, 184, 255, 0.25);
}

/* Animazioni */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Stili per gli errori di struttura */
.verse-count-error {
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 15px !important;  /* Più spazioso */
  border-radius: 6px !important;
  margin-bottom: 12px !important;
  backdrop-filter: blur(4px);     /* Effetto vetro */
}

.text-warning {
  color: #8a6d03 !important;  /* Testo più chiaro */
  background-color: rgba(255, 193, 7, 0.15) !important;
  border-left: 3px solid #ffc107 !important;
  padding: 8px 12px !important;
}

.text-danger {
  color: #a71d2a !important;   /* Rosso più leggibile */
  background-color: rgba(220, 53, 69, 0.15) !important;
  border-left: 3px solid #dc3545 !important;
  padding: 8px 12px !important;
}

.pattern-info {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-top: 12px;
}

.poem-type-badge {
  background-color: var(--haiku-primary);
  color: var(--haiku-primary);
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
}

#patternDisplay {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  justify-content: center;
  align-items: center;
  width: 100%;
  box-sizing: border-box;
  margin-bottom: 1rem;
}

/* Animazioni */
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

/* Stili specifici per il textarea */
#poemText {
  border: 1px solid rgba(255,255,255,0.1) !important;
  background-color: rgba(255, 255, 255, 0.35) !important;
}

#poemText:focus {
  background-color: rgba(255, 255, 255, 0.65) !important;
  box-shadow: 0 0 0 3px rgba(212, 184, 255, 0.15) !important;
  outline: none;
  border-color: rgba(212, 184, 255, 0.3) !important;
}

#poemText::placeholder {
  color: rgba(94, 94, 94, 0.5);
  font-style: italic;
  font-weight: 300;
}

.verse-count-error {
  animation: pulse 0.5s ease-in-out;
}

/* Stili per i titoli dei risultati */
#resultTitle {
  font-family: 'Inter', sans-serif;
  font-weight: 500;
  color: var(--text);
}

#resultMessage {
  color: var(--text);
  line-height: 1.6;
}

.alert-heading {
  border-bottom: 1px solid rgba(0,0,0,0.1);
  padding-bottom: 8px;
  margin-bottom: 12px;
}

/* Stili per il resultContainer */
#resultContainer {
  margin: 2rem auto;        /* centra orizzontalmente */
  display: flex;
  flex-direction: column;
  align-items: center;      /* centra tutti i figli */
  box-sizing: border-box;
}

#resultContainer .alert {
  border: 1px solid rgba(255, 255, 255, 0.15) !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
}

/* Stili dinamici per i diversi stati */
#resultContainer .alert-success {
  background: rgba(59, 177, 86, 0.1) !important;
  border-left: 4px solid var(--success) !important;
}

#resultContainer .alert-danger {
  background: rgba(220, 53, 69, 0.1) !important;
  border-left: 4px solid var(--error) !important;
}

#resultContainer .alert-warning {
  background: rgba(255, 193, 7, 0.17) !important;
  border-left: 4px solid var(--warning) !important;
}

/* Stili per i dettagli delle sillabe */
.verse-detail {
  padding: 12px;
  margin-bottom: 10px;
  background: rgba(5, 0, 0, 0.05);
  border-radius: 8px;
  border-left: 3px solid transparent;
}

/* Stili per l'analisi rimica */

.glass-card {
  padding: 12px;
  margin-bottom: 10px;
  background: rgba(5, 0, 0, 0.05);
  border-radius: 8px;
  border-left: 3px solid transparent;
  overflow: hidden;
  transition: all 0.3s ease;
}

/* Rhyme Container */
.rhyme-scheme-container {
  display: flex;
  flex-wrap: wrap;
  gap: 14px;
  padding: 12px 0;
}

/* Rhyme Group */
.rhyme-group {
  position: relative;
  display: flex;
  gap: 8px;
}

/* Rhyme Letter Card */
.rhyme-letter {
  width: 44px;
  height: 44px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  border-radius: 12px;
  font-weight: 600;
  font-family: 'inter', sans-serif;
  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  box-shadow: 
    0 2px 4px rgba(0, 0, 0, 0.1),
    0 0 0 1px rgba(255, 255, 255, 0.3);
}

.rhyme-letter .letter {
  font-size: 1.1em;
}

.rhyme-letter .verse-indicator {
  font-size: 0.65em;
  opacity: 0.8;
  margin-top: 2px;
  font-family: 'Inter', sans-serif;
}

/* States */
.rhyme-matched {
  background: rgba(59, 177, 86, 0.2);
  border: 1px solid rgba(59, 177, 86, 0.3);
  color: var(--success);
}

.rhyme-mismatch {
  background: rgba(220, 53, 69, 0.2);
  border: 1px solid rgba(220, 53, 69, 0.3);
  color: var(--error);
  animation: pulseAlert 1.5s infinite;
}

/* Message Boxes */
.alert-glass {
  background: rgba(255, 193, 7, 0.15);
  border-left: 3px solid #ffc107;
  padding: 12px;
  border-radius: 8px;
  display: flex;
  gap: 10px;
  align-items: flex-start;
}

.success-glass {
  background: rgba(59, 177, 86, 0.15);
  border-left: 3px solid var(--success);
  padding: 12px;
  border-radius: 8px;
  display: flex;
  gap: 10px;
  align-items: center;
}

/* Stati delle rime */
.rhyme-letter.valid {
  color: var(--text);
  background: rgba(59, 177, 86, 0.2) !important;
  border: 1px solid rgba(19, 81, 33, 0.4) !important;
}

.rhyme-letter.invalid {
  color: var(--text) !important;
  background: rgba(220, 53, 69, 0.3) !important;
  border: 1px solid rgba(220, 53, 69, 0.5) !important;
  animation: pulseMismatch 1.5s infinite;
}

/* Animazione per rime non corrispondenti */
@keyframes pulseMismatch {
  0% { opacity: 0.8; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.05); }
  100% { opacity: 0.8; transform: scale(1); }
}

/* Effetto hover per tutti i badge */
.rhyme-letter:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1) !important;
  z-index: 1;
}

.animate__pulse {
  animation-duration: 0.5s;
}

.rhyme-analysis h6 {
  color: var(--haiku-primary);
}

.verse-detail.incorrect-verse {
  border-left: 3px solid var(--error);
  animation: fadeIn 0.5s ease;
}

/* Barra di progresso personalizzata */
.progress {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
}

.progress-bar {
  border-radius: 4px;
}

/* Stili per i messaggi */
.alert-heading {
  font-family: 'Inter', sans-serif;
  font-weight: 500;
}

#resultMessage {
  color: var(--text);
  line-height: 1.6;
}

#resultMessage i {
  margin-right: 8px;
}

.a {
  color: #a084e8;
  text-decoration: underline;
  font-weight: 500;
  margin-left: 0.5em;
}
  .a:hover {
  color: #d76f43;
  text-decoration: underline;
}

/* Modal header full width fix */
.modal-header {
  width: 100% !important;
  
  padding-left: 1.5rem !important;
  padding-right: 1.5rem !important;
  box-sizing: border-box;
}


/* adattamenti per versione mobile */
@media (max-width: 900px) {
  /*bypassa le regole di Bootstrap per evitare conflitti*/
  .container, .row, .col-lg-6, .col-md-8 {
    padding-left: 0 !important;
    padding-right: 0 !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
  }

  html, body {
    background-attachment: scroll;
    /* Fallback JPG per mobile */
    background-image: url('../images/background.jpg');
  }

  /* WebP per mobile se supportato */
  @supports (background-image: url('data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA')) {
    html, body {
      background-image: url('../images/background.webp');
    }
  }

  @supports (-webkit-touch-callout: none) {
    body {
      /* Fix per Safari iOS */
      min-height: -webkit-fill-available;
    }
  }

  html {
    overflow-x: hidden;
    width: 100%;
  }

  .modal-header {
    border-top-left-radius: 1rem !important;
    border-top-right-radius: 1rem !important;
    padding-left: 1rem !important;
    padding-right: 1rem !important;
  }

  #poemText {
    font-size: 1.1em;
    min-height: 120px;
    padding: 1rem 0.7rem;
    line-height: 1.5;
    border-radius: 10px;
    box-sizing: border-box;
    width: 100%;
    max-width: 100%;
  }

  #resultContainer {
    max-width: 90vw;
    width: 90vw;
    margin: 1rem auto;
    padding: 0 0.5rem; /* <--- padding orizzontale */
    display: flex;
    flex-direction: column;
    align-items: center;
    box-sizing: border-box;
  }

  #patternDisplay {
    gap: 0.35rem;
    padding-bottom: 0.5rem;
    min-height: 50px !important; /* Altezza minima aumentata per mobile */
    height: 50px !important; /* Altezza fissa per mantenere l'allineamento */
    display: flex !important;
    justify-content: center !important;
    align-items: center !important; /* Centramento verticale dei badge */
    flex-wrap: wrap !important;
    contain: layout !important;
  }
  #patternDisplay .badge {
    font-size: 0.95em;
    padding: 0.5em 0.7em;
    min-height: 32px !important; /* Altezza coerente dei badge */
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  .p-4 {
    padding: 0.35rem !important; /* Riduci il padding su mobile */
  }

  .card,
  .glass-card {
    padding: 1.5rem 0.8rem;
    width: 100%;
    max-width: 100vw;
    margin: 0;
    border-radius: 10px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: auto !important; /* Rimuovi altezza fissa su mobile */
    height: auto !important;
  }

  body {
    padding-bottom: env(safe-area-inset-bottom);
    background: 
      url('../images/background.jpg') center/cover no-repeat fixed;
  }

  main {
    padding: 0.5rem;
    padding-bottom: 0;
    min-height: auto !important; /* Rimuovi altezza fissa su mobile */
  }
  .header-content {
    padding: 2rem 0.5rem;
  }
  .form-select {
    width: 100%;
    min-width: 0;
    padding: 0.7rem 1.2rem;
  }
  .form-select-container {
    height: auto !important; /* Altezza automatica su mobile */
    min-height: auto !important;
  }
  #poemText {
    font-size: 1rem;
    min-height: 120px;
    height: auto !important; /* Altezza flessibile su mobile */
  }
  .rhyme-scheme-container {
    gap: 8px;
    padding: 8px 0;
  }
  .rhyme-letter {
    width: 36px;
    height: 36px;
    font-size: 0.95em;
  }

  footer {
    font-size: 1em;
    padding: 0.7rem 0.2rem;
    border-radius: 0;
    width: 100%;
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Stili per i campi di pubblicazione */
  #publishFields {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 1rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      min-height: auto !important; /* Rimuovi altezza fissa su mobile */
  }

  #publishFields input {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: var(--text);
  }

  #publishFields input:focus {
      background: rgba(255, 255, 255, 0.3);
      border-color: var(--primary);
      box-shadow: 0 0 0 0.2rem rgba(212, 184, 255, 0.25);
  }

  /* Stili per la bacheca */
  .glass-card {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 15px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .glass-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(149, 117, 205, 0.15);
  }

  .poem-text {
      font-family: 'Playfair Display', serif;
      font-style: italic;
      line-height: 1.6;
      color: var(--text);
  }

  .like-btn:hover {
      background-color: var(--accent);
      border-color: var(--accent);
      color: white;
  }

  /* Toast errori più grandi per mostrare dettagli */
  .toast-body ul {
      padding-left: 1.2rem;
      margin-bottom: 0.5rem;
  }

  .toast-body ul li {
      margin-bottom: 0.2rem;
  }

  .toast.show {
      max-width: 400px; /* Toast più larghi per contenere i dettagli */
  }
}

/* Adattamenti per dispositivi extra-piccoli */
@media (max-width: 480px) {
  #patternDisplay {
    min-height: 45px !important;
    height: 45px !important;
    gap: 0.25rem !important;
    margin-bottom: 1.2rem !important;
  }

  #patternDisplay .badge {
    font-size: 0.85rem !important;
    min-width: 35px !important;
    height: 28px !important;
    line-height: 26px !important;
    padding: 0.4em 0.6em !important;
  }

  .card {
    padding: 1.2rem 0.6rem !important;
  }
}

/* Stili Desktop - Glassmorphism per publishFields */
@media (min-width: 768px) {
  /* Center actions row (checkboxes + buttons) and prevent overflow */
  .d-grid.gap-2.d-md-flex.justify-content-md-between{
    justify-content: center !important;
    align-items: center !important;
    flex-wrap: wrap;
    width: 100%;
    margin: 0 auto;
    row-gap: 0.75rem;
    column-gap: 1rem;
  }
  .d-grid.gap-2.d-md-flex.justify-content-md-between > .d-flex{
    max-width: 100%;
    flex: 0 1 auto;
  }
  .d-grid.gap-2.d-md-flex.justify-content-md-between > .d-flex.flex-column{
    min-width: 0 !important; /* avoid forcing overflow */
  }
  #publishFields {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    min-height: 80px; /* Fixed height for CLS prevention */
  }

  #publishFields:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: rgba(255, 255, 255, 0.3);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
  }

  #publishFields input {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.25);
    border-radius: 8px;
    color: var(--text, #333);
    transition: all 0.3s ease;
  }

  #publishFields input:focus {
    background: rgba(255, 255, 255, 0.25);
    border-color: var(--primary, #a084e8);
    box-shadow: 0 0 0 0.2rem rgba(212, 184, 255, 0.25);
    transform: scale(1.02);
  }

  #publishFields input:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.35);
  }

  #publishFields input::placeholder {
    color: var(--text, #333);
  }
}

/* Desktop (>=992px) flexible overrides */
@media (min-width: 992px){
  .card{min-height:clamp(520px,60vh,780px);max-width:640px;margin:2rem auto;display:flex;flex-direction:column;overflow:visible}
  .card-body{flex:1;display:flex;flex-direction:column;overflow:visible;padding:2rem}
  #patternDisplay{min-height:50px;height:auto;max-height:none;overflow:visible;gap:.5rem;margin-bottom:1rem}
  .badge.syllable-badge{padding:0 .75rem;min-height:32px;line-height:1.1;font-size:.8rem;white-space:nowrap;max-width:100%;overflow:visible;text-overflow:clip}
  .form-select-container{height:auto;min-height:120px;max-height:none;justify-content:flex-start}
  #poemText{min-height:150px;height:auto;max-height:none;resize:vertical;}
  #resultContainer{min-height:80px;contain:initial;margin-top:1.25rem}
  #publishFields[style*="display: block"]{height:auto!important;min-height:80px!important;max-height:none!important}
  .d-grid.gap-2.d-md-flex.justify-content-md-between{min-height:unset;contain:initial}
  .btn-haiku{height:auto;min-height:44px}
  .container,.row{contain:initial}
}

/* ============================
  Custom Animated Checkbox
  Applied to #publishPoem + #useTolerance using .check class
  ============================ */
.check{cursor:pointer;position:relative;margin:0;width:18px;height:18px;-webkit-tap-highlight-color:transparent;transform:translate3d(0,0,0)}
.check:before{content:"";position:absolute;top:-15px;left:-15px;width:48px;height:48px;border-radius:50%;background:rgba(34,50,84,0.03);opacity:0;transition:opacity .2s ease}
.check svg{position:relative;z-index:1;fill:none;stroke-linecap:round;stroke-linejoin:round;stroke:#ffffff69;stroke-width:1.5;transform:translate3d(0,0,0);transition:all .2s ease}
.check svg path{stroke-dasharray:60;stroke-dashoffset:0}
.check svg polyline{stroke-dasharray:22;stroke-dashoffset:66}
.check:hover:before{opacity:1}
.check:hover svg{stroke:#A971FF}
#publishPoem:checked + .check svg,#useTolerance:checked + .check svg{stroke:#A971FF}
#publishPoem:checked + .check svg path,#useTolerance:checked + .check svg path{stroke-dashoffset:60;transition:all .3s linear}
#publishPoem:checked + .check svg polyline,#useTolerance:checked + .check svg polyline{stroke-dashoffset:42;transition:all .2s linear;transition-delay:.15s}
/* Label styling next to checkbox */
label[for=publishPoem].small,label[for=useTolerance].small{font-size:.8rem;line-height:1.2}
/* Accessible visually hidden checkbox (focusable, SR-visible) */
.visually-hidden-checkbox{position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0 0 0 0)!important;white-space:nowrap!important;border:0!important}
