<!DOCTYPE html>
<html lang="it">
<head>
    <!-- ====== META BASE / SEO ====== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="robots" content="index, follow">
    <title>Haiku Online & Analizzatore Metrico | Ale's Haikus</title>
    <meta name="description" content="Scrivi e analizza haiku online: analizzatore metrico avanzato per poesie brevi, tanka, sonetti e versi liberi. Crea, ottimizza e condividi le tue poesie.">
    <meta name="keywords" content="haiku online, analizzatore metrica, poesie brevi, scrivere haiku, conta sillabe poesia, tanka, sonetto, poesia italiana, poesia giapponese">
    <link rel="canonical" href="https://www.aleshaikus.me/landing">
    <meta name="theme-color" content="#faf7ff">

    <!-- Open Graph / Twitter -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Haiku Online & Analizzatore Metrico | Ale's Haikus">
    <meta property="og:description" content="Strumento gratuito per scrivere e verificare haiku, tanka e altre poesie. Scopri, impara e crea.">
    <meta property="og:image" content="https://www.aleshaikus.me/static/og-image.jpg">
    <meta property="og:url" content="https://www.aleshaikus.me/landing">
    <meta name="twitter:card" content="summary_large_image">

    <!-- Favicons (riuso set esistente) -->
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon.png') }}?v=1.2">
    <link rel="icon" type="image/png" sizes="96x96" href="{{ url_for('static', filename='favicon-96x96.png') }}?v=1.2">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}?v=1.2">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon-16x16.png') }}?v=1.2">
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}?v=1.2">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}?v=1.2">
    <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}?v=1.2">

    <!-- Preconnect / Performance Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">

    <!-- Preload hero background (WebP fallback) -->
    <link rel="preload" as="image" href="{{ url_for('static', filename='images/background.webp') }}">

    <!-- Inline Critical CSS (Hero + Navbar + Above the fold) -->
    <style>
    :root{--primary:#D4B8FF;--secondary:#FFE5D9;--accent:#A2D7D8;--text:#5E5E5E;--bg:#FAF7FF;--gradient:linear-gradient(135deg,#cca9ff 0%,#ffb18d 100%)}
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{min-height:100%;font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#faf7ff;color:var(--text);-webkit-font-smoothing:antialiased}
    body.loading{background:#fbbda3!important}
    a{text-decoration:none;color:inherit}
    img{max-width:100%;height:auto;display:block}
    .visually-hidden{position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0 0 0 0)!important;white-space:nowrap!important;border:0!important}
    header{position:relative;z-index:10}
    .navbar{display:flex;align-items:center;justify-content:center;padding:.6rem 1rem;background:rgba(255,255,255,0.12);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,0.18)}
    .nav-list{list-style:none;display:flex;gap:.85rem;margin:0;padding:0}
    .nav-list a{display:inline-flex;align-items:center;padding:.45rem .9rem;border-radius:.75rem;font-weight:500;color:#fff;font-size:.95rem;transition:background .3s ease}
    .nav-list a:hover,.nav-list a:focus-visible{background:rgba(255,255,255,0.18);outline:none}
    .hero{position:relative;isolation:isolate;display:flex;align-items:center;justify-content:center;text-align:center;padding:clamp(3.5rem,12vh,7.5rem) 1rem;overflow:hidden;background:var(--gradient);color:#fff}
    .hero:before{content:"";position:absolute;inset:0;background:radial-gradient(circle at 30% 40%,rgba(255,255,255,.25),transparent 60%),radial-gradient(circle at 70% 60%,rgba(255,255,255,.18),transparent 65%);mix-blend-mode:overlay;pointer-events:none}
    .hero-inner{max-width:960px;margin-inline:auto;display:flex;flex-direction:column;gap:1.25rem}
    h1{font-size:clamp(2.15rem,4.2vw,3.35rem);line-height:1.08;font-weight:600;letter-spacing:-.5px;margin:0;font-family:'Inter',sans-serif}
    .hero-sub{font-size:clamp(1.05rem,1.4vw,1.35rem);font-weight:300;line-height:1.45;margin:0 auto;max-width:760px}
    .cta-wrap{display:flex;flex-wrap:wrap;justify-content:center;gap:.85rem;margin-top:.5rem}
    .btn{--btn-bg:var(--primary);--btn-color:#282828;position:relative;display:inline-flex;align-items:center;justify-content:center;padding:.85rem 1.4rem;border-radius:2rem;font-size:.97rem;font-weight:600;line-height:1.1;background:var(--btn-bg);color:var(--btn-color);border:2px solid rgba(255,255,255,0.35);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);box-shadow:0 8px 20px -6px rgba(0,0,0,.18),0 1px 4px rgba(0,0,0,.08);cursor:pointer;transition:transform .35s cubic-bezier(.16,.8,.32,1),box-shadow .35s ease,background .35s ease}
    .btn-primary{--btn-bg:rgba(255,255,255,0.82);--btn-color:#4a3c62}
    .btn-accent{--btn-bg:#A2D7D8;--btn-color:#10393d}
    .btn-gradient{--btn-bg:linear-gradient(90deg,#d4b8ff,#ffe5d9);--btn-color:#4a3c62}
    .btn:hover{transform:translateY(-4px);box-shadow:0 12px 28px -8px rgba(0,0,0,.25),0 4px 10px rgba(0,0,0,.12)}
    .btn:active{transform:translateY(-1px)}
    .btn:focus-visible{outline:2px solid #fff;outline-offset:2px}
    .scroll-indicator{margin-top:2.25rem;opacity:.85;font-size:.8rem;letter-spacing:.15em;text-transform:uppercase;display:inline-flex;align-items:center;gap:.35rem;font-weight:500}
    .pulse-dot{width:8px;height:8px;border-radius:50%;background:#fff;box-shadow:0 0 0 0 rgba(255,255,255,.6);animation:pulse 2.2s infinite}
    @keyframes pulse{to{box-shadow:0 0 0 14px rgba(255,255,255,0);transform:scale(.9)}}
    .features{background:#faf7ff;position:relative;padding:clamp(3.5rem,10vh,5.5rem) 1rem 3.5rem}
    .features-grid{--min:250px;display:grid;grid-template-columns:repeat(auto-fit,minmax(var(--min),1fr));gap:1.75rem;max-width:1140px;margin:0 auto}
    .feature-card{position:relative;padding:1.4rem 1.35rem 1.6rem;border-radius:1.25rem;background:rgba(255,255,255,.75);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.55);box-shadow:0 4px 26px -10px rgba(0,0,0,.1),0 2px 8px -2px rgba(0,0,0,.05);display:flex;flex-direction:column;gap:.65rem;overflow:hidden;min-height:200px;opacity:0;transform:translateY(28px);will-change:transform,opacity}
    .feature-card h3{font-size:1.05rem;margin:0;font-weight:600;color:#4a3c62;display:flex;align-items:center;gap:.5rem}
    .feature-card p{margin:0;font-size:.9rem;line-height:1.45;color:#5e5e5e}
    .tag-pill{display:inline-block;background:linear-gradient(90deg,#cca9ff,#ffb18d);font-size:.65rem;letter-spacing:.07em;font-weight:600;padding:.35rem .7rem;border-radius:2rem;color:#fff;text-transform:uppercase}
    .section-head{max-width:820px;margin:0 auto 2.2rem;text-align:center}
    .section-head h2{font-size:clamp(1.65rem,2.8vw,2.15rem);margin:.25rem 0;font-weight:600;letter-spacing:-.5px;color:#4a3c62}
    .section-head p{font-size:1rem;line-height:1.55;margin:0 auto;max-width:680px;color:#665c73}
    .seo-block{background:linear-gradient(135deg,#f3ecff,#fff);padding:3.25rem 1rem 3.75rem;margin:0;position:relative}
    .seo-inner{max-width:1080px;margin:0 auto;display:grid;gap:2.5rem;grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
    .seo-card{padding:1.4rem 1.25rem 1.6rem;border-radius:1rem;background:#fff;box-shadow:0 6px 18px -6px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:.55rem;opacity:0;transform:translateY(26px);will-change:opacity,transform}
    .seo-card h3{margin:0;font-size:1rem;font-weight:600;color:#403655}
    .seo-card p{margin:0;font-size:.85rem;line-height:1.45;color:#595063}
    footer{background:#1e142c;color:#fff;text-align:center;padding:2.25rem 1rem 2.75rem;margin-top:0;font-size:.8rem;line-height:1.4;position:relative}
    footer a{color:#d4b8ff}
    .footer-links{display:flex;justify-content:center;gap:1.25rem;flex-wrap:wrap;margin:.85rem 0 1.15rem;font-size:.75rem;letter-spacing:.05em;text-transform:uppercase}
    .lazy-illustration{max-width:720px;margin:2.2rem auto 0;border-radius:1.25rem;box-shadow:0 18px 38px -18px rgba(0,0,0,.25),0 4px 16px -4px rgba(0,0,0,.12);opacity:0;transform:translateY(40px);transition:opacity .9s cubic-bezier(.16,.8,.32,1),transform .9s cubic-bezier(.16,.8,.32,1)}
    .lazy-illustration.loaded{opacity:1;transform:translateY(0)}
    @media (max-width:640px){.hero-inner{gap:1rem}.cta-wrap{flex-direction:column}.nav-list{gap:.4rem}.nav-list a{font-size:.85rem;padding:.4rem .7rem}.feature-card{min-height:unset}.footer-links{flex-direction:column;gap:.4rem}}
    @media (prefers-reduced-motion:reduce){.feature-card,.seo-card,.lazy-illustration{animation:none!important;transition:none!important;transform:none!important;opacity:1!important}.btn{transition:none}}
    </style>

    <!-- Preload & Load Non-critical CSS (Landing specific) -->
    <link rel="preload" href="{{ url_for('static', filename='css/landing.css') }}?v=0.1" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="{{ url_for('static', filename='css/landing.css') }}?v=0.1"></noscript>
    <link rel="preload" href="{{ url_for('static', filename='css/icons.css') }}?v=1.4" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="{{ url_for('static', filename='css/icons.css') }}?v=1.4"></noscript>

    <!-- Font Display Swap (minimal subset inline) -->
    <style>
    @font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF;}
    @font-face{font-family:'Playfair Display';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/playfairdisplay/v36/nuFvD-vYSZviVYUb_rj3ij__anPXJzDwcbmjWBN2PKdFvXDYbtXK-F2qC0s.woff2) format('woff2');unicode-range:U+0000-00FF;}
    </style>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:ital@1&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:ital@1&display=swap"></noscript>

    <script>document.documentElement.classList.add('js');</script>

    <!-- Structured Data (WebSite + WebPage + FAQ) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "Ale's Haikus Landing",
      "description": "Landing page di ale's haikus,l'analizzatore metrico per haiku e poesie brevi online.",
      "url": "https://www.aleshaikus.me/landing",
      "publisher": {"@type": "Organization","name": "Ale's Haikus"},
      "mainEntity": {
        "@type": "SoftwareApplication",
        "name": "Ale's Poetry Analyzer",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Web",
        "offers": {"@type":"Offer","price":"0","priceCurrency":"EUR"}
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {"@type": "Question","name": "Come contare le sillabe in un haiku?","acceptedAnswer": {"@type": "Answer","text": "Inserisci i tuoi versi nell'analizzatore e riceverai il conteggio automatico con gestione di dittonghi, sineresi e eccezioni linguistiche."}},
        {"@type": "Question","name": "Posso analizzare altre forme oltre agli haiku?","acceptedAnswer": {"@type": "Answer","text": "Sì, supportiamo tanka, limerick, sonetto, versi liberi e altre strutture poetiche."}},
        {"@type": "Question","name": "Il servizio è gratuito?","acceptedAnswer": {"@type": "Answer","text": "Sì, l'analizzatore è gratuito e non richiede registrazione."}}
      ]
    }
    </script>

    <!-- Anime.js per animazioni (verrà usato in una fase successiva) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha512-98Z8HOaQ8zUQ+6Q671O5jM90oCbGyF/F7kh/3Gzdh0dX8GZFODdgNpTi27C/7h6CkCmZomYuoFkLMK8L+Hk8mw==" crossorigin="anonymous" referrerpolicy="no-referrer" defer></script>
    <!-- JS Landing (defer) -->
    <script defer src="{{ url_for('static', filename='js/landing.js') }}?v=0.1"></script>
</head>
<body class="loading">
    <a href="#contenuto" class="visually-hidden focusable">Salta al contenuto</a>
    <header>
        <nav class="navbar" aria-label="Navigazione principale">
            <ul class="nav-list">
                <li><a href="{{ url_for('web.index') }}" title="Analizzatore poetico">Analizza</a></li>
                <li><a href="{{ url_for('web.bacheca') }}" title="Bacheca poesie">Bacheca</a></li>
                <li><a href="{{ url_for('web.wiki') }}" title="Wiki poetica">Wiki</a></li>
            </ul>
        </nav>
    </header>

    <main id="contenuto">
        <!-- HERO -->
        <section class="hero" aria-labelledby="hero-title">
            <div class="hero-inner">
                <span class="tag-pill" aria-hidden="true">Beta Evoluta</span>
                <h1 id="hero-title">Scrivi, Analizza e Condividi Haiku & Poesie in Tempo Reale</h1>
                <p class="hero-sub">Uno <strong>strumento metrico intelligente</strong> per haiku, tanka, sonetti e versi liberi. Conta sillabe, verifica schemi e lasciati ispirare dalla community.
                </p>
                <div class="cta-wrap" role="group" aria-label="Azioni principali">
                    <a class="btn btn-primary" href="{{ url_for('web.index') }}" title="Vai all'analizzatore" data-cta="analyze">Inizia Subito</a>
                    <a class="btn btn-accent" href="{{ url_for('web.bacheca') }}" title="Scopri la bacheca" data-cta="bacheca">Haiku della Community</a>
                    <a class="btn btn-gradient" href="{{ url_for('web.wiki') }}" title="Leggi la wiki poetica" data-cta="wiki">Impara le Forme</a>
                </div>
                <span class="scroll-indicator" aria-hidden="true"><span class="pulse-dot"></span> Scorri per scoprire</span>
            </div>
        </section>

        <!-- FEATURE PRINCIPALI -->
        <section class="features" id="funzioni" aria-labelledby="feat-title">
            <div class="section-head">
                <h2 id="feat-title">Perché usare Ale's Haikus?</h2>
                <p>Ottimizzato per <em>performance</em>, precisione metrica e SEO. Creato per poeti digitali, studenti e creatori di contenuti.</p>
            </div>
            <div class="features-grid" role="list">
                <article class="feature-card" role="listitem">
                    <h3><i class="bi bi-cpu"></i> Analisi metrica avanzata</h3>
                    <p>Algoritmi che gestiscono dittonghi, trittonghi, sinalefi, iati ed eccezioni per un conteggio sillabico affidabile.</p>
                </article>
                <article class="feature-card" role="listitem">
                    <h3><i class="bi bi-lightning-charge"></i> Ultra rapido & ottimizzato</h3>
                    <p>Critical CSS inline, lazy loading, preloading mirato e JS modulare per punteggi alti su PageSpeed.</p>
                </article>
                <article class="feature-card" role="listitem">
                    <h3><i class="bi bi-people"></i> Community poetica</h3>
                    <p>Pubblica e scopri poesie brevi originali, filtra per autore e tipologia, trova ispirazione.</p>
                </article>
                <article class="feature-card" role="listitem">
                    <h3><i class="bi bi-journal-text"></i> Wiki integrata</h3>
                    <p>Forme poetiche spiegate chiaramente: haiku, tanka, sonetto, limerick, versi liberi e altro.</p>
                </article>
                <article class="feature-card" role="listitem">
                    <h3><i class="bi bi-shield-check"></i> Accessibilità & UX</h3>
                    <p>Focus visibili, riduzione motion, colori leggibili e struttura semantica ottimizzata.</p>
                </article>
                <article class="feature-card" role="listitem">
                    <h3><i class="bi bi-rocket-takeoff"></i> Pronto per crescere</h3>
                    <p>Architettura modulare, CDN-friendly, caching e progressive enhancement senza blocchi.</p>
                </article>
            </div>

            <picture class="lazy-illustration" data-ll="true">
                <source type="image/webp" srcset="{{ url_for('static', filename='images/background.webp') }}">
                <img src="{{ url_for('static', filename='images/background.jpg') }}" alt="Astratto sfumato viola e arancio ispirazione poetica" width="1280" height="720" loading="lazy" decoding="async">
            </picture>
        </section>

        <!-- BLOCCO SEO / BENEFITS -->
        <section class="seo-block" aria-labelledby="seo-head">
            <div class="section-head">
                <h2 id="seo-head">Ottimizzato per Poeti e Motori di Ricerca</h2>
                <p>Performance core web vitals elevate e contenuti semantici pensati per <strong>haiku online</strong>, <strong>poesie brevi</strong> e <strong>scrivere haiku</strong>.</p>
            </div>
            <div class="seo-inner">
                <div class="seo-card">
                    <h3><i class="bi bi-graph-up"></i> Struttura semantica</h3>
                    <p>Heading gerarchici (H1-H2-H3), alt testuali e JSON-LD per valorizzare il contenuto.</p>
                </div>
                <div class="seo-card">
                    <h3><i class="bi bi-search"></i> Keyword naturali</h3>
                    <p>Focus su "haiku online", "poesie brevi" e varianti correlate utilizzate in modo organico.</p>
                </div>
                <div class="seo-card">
                    <h3><i class="bi bi-speedometer2"></i> Core Web Vitals</h3>
                    <p>Minimizzazione blocchi render, inline critical path, lazy loading e moduli differiti.</p>
                </div>
                <div class="seo-card">
                    <h3><i class="bi bi-diagram-3"></i> Dati strutturati</h3>
                    <p>Snippet avanzati (FAQ + SoftwareApplication) per CTR più alto nei risultati di ricerca.</p>
                </div>
                <div class="seo-card">
                    <h3><i class="bi bi-cloud-arrow-down"></i> Caching pronto</h3>
                    <p>File fingerprintabili (?v=) e risorse comprimibili via GZIP/Brotli sul server.</p>
                </div>
                <div class="seo-card">
                    <h3><i class="bi bi-magic"></i> Animazioni progressive</h3>
                    <p>Anime.js inizializzato solo se disponibile; fallback CSS per contenuti essenziali.</p>
                </div>
            </div>
        </section>

        <!-- SEZIONE TEST ANIMAZIONE SVG (solo per sviluppo) -->
                <section id="morphing-test" aria-labelledby="morphing-title" style="background:#111;padding:3.5rem 1rem;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1.5rem;">
            <h2 id="morphing-title" style="color:#fff;font-size:1.35rem;margin:0;font-weight:600;letter-spacing:.5px;">Test Animazione Morphing</h2>
            <p style="color:#bbb;font-size:.9rem;max-width:620px;text-align:center;margin:0;">Sezione temporanea per provare il morphing di un path SVG con <code>anime.js</code>. Non indicizzata: verrà rimossa o ottimizzata in produzione.</p>
            <div style="width:100%;max-width:520px;aspect-ratio:2/1;display:flex;align-items:center;justify-content:center;">
                                <svg viewBox="0 0 400 200" role="img" aria-label="Animazione morphing path" style="width:100%;height:100%;overflow:visible">
                                        <!-- Path iniziale "curva" -->
                                        <path id="morphingPath" d="M30 150 C140 40 260 240 370 100" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round" />
                </svg>
            </div>
            <button type="button" id="restartMorph" class="btn btn-accent" style="--btn-bg:#A2D7D8;--btn-color:#10393d;">Restart</button>
            <script>
                        (function(){
                            // Carica dinamicamente flubber se non presente (solo per test dev)
                            function ensureFlubber(cb){
                                if(window.flubber){return cb();}
                                const s=document.createElement('script');
                                s.src='https://unpkg.com/flubber@0.4.2/dist/flubber.min.js';
                                s.defer=true; s.onload=cb; document.head.appendChild(s);
                            }

                            // Path finale che disegna una parola stilizzata "HAIKU" come singolo tracciato (semplificato/monoline)
                            // NOTA: È un contorno molto minimale pensato solo per test morphing.
                            const FINAL_PATH = "M40 150 L40 60 L40 105 L80 105 L80 60 L80 150 M120 60 L120 150 M120 105 L160 105 M160 60 L160 150 M200 60 L240 150 M240 60 L200 150 M280 60 L280 150 L320 150 L320 60 M280 105 L320 105";
                            const INITIAL_PATH = document.getElementById('morphingPath').getAttribute('d');
                            let directionForward = true;
                            let animInstance = null;

                            function buildAnimation(){
                                if(!window.anime){return setTimeout(buildAnimation,120);} // attende anime.js
                                ensureFlubber(()=>{
                                    if(!window.flubber){return;}
                                    // Crea interpolatori (curve -> testo) e (testo -> curve)
                                    const toText = window.flubber.interpolate(INITIAL_PATH, FINAL_PATH, { maxSegmentLength: 8 });
                                    const toCurve = window.flubber.interpolate(FINAL_PATH, INITIAL_PATH, { maxSegmentLength: 8 });
                                    const pathEl = document.getElementById('morphingPath');
                                    if(!pathEl) return;
                                    // Arresta precedente
                                    if(animInstance) animInstance.pause();
                                    animInstance = window.anime({
                                        targets:{progress:0},
                                        progress:1,
                                        duration:4000,
                                        easing:'easeInOutCubic',
                                        direction:'alternate',
                                        loop:true,
                                        update:anim=>{
                                            const p = anim.animations[0].currentValue; // valore 0..1
                                            // Decide direzione
                                            const d = directionForward ? toText(p) : toCurve(p);
                                            pathEl.setAttribute('d', d);
                                        },
                                        loopBegin:()=>{ directionForward = !directionForward; }
                                    });
                                });
                            }

                            function restart(){
                                directionForward = true;
                                buildAnimation();
                            }

                            window.addEventListener('load', buildAnimation);
                            document.getElementById('restartMorph').addEventListener('click', restart);
                        })();
            </script>
        </section>
    </main>

    <footer>
        <div class="footer-links" aria-label="Link utili">
            <a href="{{ url_for('web.index') }}">Analizzatore</a>
            <a href="{{ url_for('web.bacheca') }}">Bacheca</a>
            <a href="{{ url_for('web.wiki') }}">Wiki</a>
            <a href="/sitemap.xml">Sitemap</a>
            <a href="/robots.txt">Robots</a>
        </div>
        <p>&copy; <span id="year"></span> Ale's Haikus – poesia digitale e metrica intelligente.<br><small>dedicato a tutti i poeti innamorati e alle loro muse</small></p>
    </footer>

    <script>
    // Rimozione stato loading appena possibile
    window.addEventListener('DOMContentLoaded',()=>{document.body.classList.remove('loading');});
    </script>
</body>
</html>